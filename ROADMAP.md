# Roadmap

This is a basic road map that gives a rough idea how the project will continue.

- [x] Being able to perform _some_ translations [PR#3](https://github.com/GridTools/jace/pull/3).
- [ ] Basic functionalities:
  - [ ] Annotation `@jace.jit`.
  - [ ] Composable with Jax, i.e. take the Jax derivative of a Jace annotated function.
  - [ ] Implementing the `stages` model that is supported by Jax.
  - [ ] Cache the compilation and lowering for reuse (In the beginning probably use a self made cache).
  - [ ] Handling Jax arrays as native input (only on single host).
  - [ ] Static arguments.
- [ ] Implementing some basic `PrimitiveTranslators`, that allows us to run some early tests, such as:
  - [ ] Passing the [pyhpc-benchmark](https://github.com/dionhaefner/pyhpc-benchmarks)
        Prototype passes a lot of it, but the
  - [ ] Passing Felix' fluid project; possibility.
- [ ] Stop relying on `jax.make_jaxpr()`.
      Look at the `jax._src.pjit.make_jit()` function for how to hijack the staging process.
- [ ] Implementing more advanced primitives
  - [ ] Handling pytrees as arguments.
  - [ ] Implement random numbers.
  - [ ] `jax.numpy`.
  - [ ] `jax.scipy`.
- [ ] Passing the single host Jax unittests.
- [ ] Multi-Device capabilities, i.e. multiple GPUs all on the same host.
  - [ ] Passing the associated unit tests.
- [ ] Multi-Host capabilities, i.e. MPI.
  - [ ] Passing the associated unit tests.


## General

These are more general topics that should be addressed at one point.

- [ ] Increase the dispatching speed (Jax does this in C++; impossible to beat in Python).
- [ ] Integrating better with Jax
  - [ ] Support its array type (probably implement this in DaCe).
  - [ ] Using the cache system of Jax.
- [ ] Debugging information.
- [ ] Dynamic shapes
      This could be done by making the inputs fully dynamic, and then use the primitives to simplify.
      For example in an addition the shape of the two inputs and the outputs are the same.
      That is knowledge that is inherent to the primitives itself.
  - [ ] The dispatcher, i.e. wrapper around the `CompiledSDFG` must extract them itself, for compatibility with Jax.


# Optimization

The SDFG generated by Jace have a very particular structure, thus we can and probably should write some highly targeted optimization passes for them.
Currently there are only:

- [ ] Modified state fusion, since we have state by state and a functional flavour, which we can exploit.
- [ ] Modified Map fusion transformation.
      We should still support parallel and serial fusion as the prototype did, but focusing on serial.
